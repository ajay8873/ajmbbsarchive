<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AJ MBBS Archive | Clinical Resource Hub</title>
    
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');

        :root {
            --primary: #6c5ce7;
            --secondary: #00cec9;
            --bg-dark: #020617;
            --card-bg: #0f172a;
            --text-main: #f1f5f9;
            --text-sub: #94a3b8;
            --nav-border: rgba(30, 41, 59, 0.8);
            --glass: rgba(15, 23, 42, 0.95);
            --search-bg: rgba(255, 255, 255, 0.05);
        }

        body.light-mode {
            --bg-dark: #f8fafc;
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --text-sub: #64748b;
            --nav-border: rgba(226, 232, 240, 0.8);
            --glass: rgba(255, 255, 255, 0.95);
            --search-bg: rgba(0, 0, 0, 0.05);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; transition: background 0.3s, color 0.3s, border 0.3s; }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background: var(--bg-dark);
            color: var(--text-main);
            line-height: 1.6;
            padding-top: 80px;
            overflow-x: hidden;
        }

        header {
            position: fixed; top: 0; width: 100%; height: 75px;
            background: var(--glass); backdrop-filter: blur(15px);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 5%; z-index: 1000; border-bottom: 1px solid var(--nav-border);
        }

        .header-left { display: flex; align-items: center; gap: 15px; }
        .header-title { font-weight: 800; font-size: 1.1rem; text-transform: uppercase; letter-spacing: 1px; }
        .header-title span { color: var(--primary); }

        /* SEARCH BAR & SUGGESTIONS STYLING */
        .search-container { flex: 1; max-width: 400px; margin: 0 20px; position: relative; }
        .search-bar {
            width: 100%; padding: 10px 15px 10px 40px; border-radius: 12px;
            border: 1px solid var(--nav-border); background: var(--search-bg);
            color: var(--text-main); font-family: inherit; font-size: 0.85rem; outline: none;
        }
        .search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); opacity: 0.5; pointer-events: none; }

        .suggestions-box {
            position: absolute; top: 100%; left: 0; width: 100%;
            background: var(--card-bg); border: 1px solid var(--nav-border);
            border-radius: 12px; margin-top: 8px; max-height: 300px;
            overflow-y: auto; display: none; z-index: 3000;
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }
        .suggestion-item {
            padding: 12px 15px; cursor: pointer; border-bottom: 1px solid var(--nav-border);
            display: flex; justify-content: space-between; align-items: center;
        }
        .suggestion-item:hover { background: var(--primary); color: white; }
        .suggestion-item span:first-child { font-weight: 600; font-size: 0.85rem; }
        .suggestion-item .platform-tag { font-size: 0.6rem; font-weight: 800; padding: 2px 6px; background: rgba(108, 92, 231, 0.15); border-radius: 4px; text-transform: uppercase; color: var(--primary); }
        .suggestion-item:hover .platform-tag { color: white; background: rgba(255,255,255,0.2); }

        .menu-toggle { cursor: pointer; display: flex; flex-direction: column; gap: 5px; }
        .bar { width: 22px; height: 2px; background: var(--text-main); border-radius: 2px; }

        .side-menu {
            position: fixed; top: 0; left: -320px; width: 300px; height: 100vh;
            background: var(--card-bg); z-index: 2000; transition: 0.5s;
            padding: 20px; box-shadow: 10px 0 30px rgba(0,0,0,0.2);
        }
        .side-menu.active { left: 0; }
        .side-menu-header { margin-top: 60px; margin-bottom: 20px; }
        .menu-links { list-style: none; }
        .menu-links li a { 
            display: block; padding: 15px; text-decoration: none; color: var(--text-main); 
            font-weight: 600; font-size: 0.9rem; border-radius: 12px; margin-bottom: 5px;
        }
        .menu-links li a:hover { background: var(--primary); color: white; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; z-index: 1500; }
        .overlay.active { display: block; }

        #themeToggle { background: none; border: none; cursor: pointer; color: var(--text-main); padding: 5px; }

        .countdown-wrap {
            width: 92%; max-width: 1000px; margin: 20px auto;
            background: linear-gradient(135deg, rgba(108, 92, 231, 0.1), rgba(0, 206, 201, 0.1));
            border: 1px solid var(--nav-border); border-radius: 25px;
            padding: 25px; text-align: center;
        }
        .timer-grid { display: flex; justify-content: center; gap: 12px; margin-top: 15px; }
        .t-unit { background: var(--card-bg); padding: 12px; border-radius: 15px; min-width: 70px; border: 1px solid var(--nav-border); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .t-num { display: block; font-size: 1.6rem; font-weight: 800; color: var(--primary); }
        .t-lab { font-size: 0.65rem; font-weight: 700; text-transform: uppercase; color: var(--text-sub); }

        /* BRANDING */
        .hero-section { width: 92%; max-width: 1000px; margin: 40px auto; text-align: center; }
        .hero-branding { position: relative; display: inline-block; padding: 0 20px; }
        .hero-branding h1 { 
            font-size: 2.6rem; font-weight: 800; letter-spacing: -1px; margin-bottom: 5px;
            background: linear-gradient(to right, var(--text-main), var(--primary));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .hero-branding::before, .hero-branding::after {
            content: '['; position: absolute; top: 0; font-size: 2.5rem; font-weight: 300; color: var(--primary); opacity: 0.5;
        }
        .hero-branding::before { left: -10px; }
        .hero-branding::after { content: ']'; right: -10px; }
        .hero-divider { width: 50px; height: 5px; background: var(--primary); margin: 15px auto; border-radius: 50px; box-shadow: 0 0 15px var(--primary); }
        
        .hero-description { color: var(--text-sub); max-width: 700px; margin: 0 auto 40px; font-weight: 500; font-size: 0.95rem; }

        .carousel-wrapper { width: 100%; max-width: 850px; margin: 0 auto; height: 310px; border-radius: 35px; overflow: hidden; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.4);perspective: 1000px; /* Adds depth */ }
        .carousel-track { display: flex; width: 300%; height: 100%; animation: slide 12s infinite ease-in-out; }
        .slide { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; text-decoration: none; }
        .slide1 { background: linear-gradient(45deg, #6c5ce7, #a29bfe); }
        .slide2 { background: linear-gradient(45deg, #ef4444, #ff7675); }
        .slide3 { background: linear-gradient(45deg, #00cec9, #81ecec); }
        .glass { background: rgba(255,255,255,0.12); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.25); padding: 35px; border-radius: 30px; color: white; width: 85%; 
            
        }

        @keyframes slide { 0%, 30% { transform: translateX(0); } 33%, 63% { transform: translateX(-33.33%); } 66%, 100% { transform: translateX(-66.66%); } }

        /* PLATFORM GRID */
        .platform-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; width: 92%; max-width: 1000px; margin: 50px auto; }
        .platform-card { 
            background: var(--card-bg); border-radius: 28px; padding: 40px 20px; text-decoration: none; 
            text-align: center; border: 1px solid var(--nav-border); box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .platform-card:hover { transform: translateY(-12px); border-color: var(--primary); box-shadow: 0 20px 40px rgba(108, 92, 231, 0.15); }
        
        .icon-box { 
            width: 70px; height: 70px; margin: 0 auto 25px; 
            background: rgba(108, 92, 231, 0.08); border-radius: 22px; 
            display: flex; align-items: center; justify-content: center;
            border: 1px solid rgba(108, 92, 231, 0.15);
        }

        /* ICONS VISIBILITY FIX FOR BOTH MODES */
        .icon-box img { width: 35px; height: 35px; transition: 0.5s; }
        body.dark-mode .icon-box img { filter: brightness(0) invert(1); }
        body.light-mode .icon-box img { filter: none !important; }

        .name { font-weight: 800; font-size: 1.1rem; color: var(--text-main); margin-bottom: 8px; letter-spacing: -0.5px; }
        .desc { font-size: 0.7rem; color: var(--text-sub); font-weight: 700; text-transform: uppercase; letter-spacing: 1px; }

        .disclaimer { width: 92%; max-width: 850px; margin: 60px auto; padding: 30px; border-radius: 22px; background: rgba(239, 68, 68, 0.04); border-left: 6px solid #ef4444; }
        footer { text-align: center; padding: 20px; color: var(--text-sub); border-top: 1px solid var(--nav-border); font-size: 0.85rem; font-weight: 700; letter-spacing: 1px; }

        @media (max-width: 768px) { 
            header .search-container { display: none; } 
            .platform-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; } 
            .hero-branding h1 { font-size: 2.1rem; } 
            .platform-card { padding: 30px 10px; }
        }
    #install-item a {
    margin: 10px;
    border-radius: 12px;
    text-align: center;
    animation: pulseInstall 2s infinite;
}

@keyframes pulseInstall {
    0% { opacity: 0.8; }
    50% { opacity: 1; transform: scale(1.02); }
    100% { opacity: 0.8; }
}

    #splash-screen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #020617; z-index: 9999;
    display: flex; align-items: center; justify-content: center;
    transition: opacity 0.8s ease, visibility 0.8s;
}

.splash-content { text-align: center; }
.pulse-logo {
    margin-bottom: 20px;
    display: flex;
    justify-content: center;
}

.ecg-line {
    /* dasharray creates the 'line' and 'gap' */
    stroke-dasharray: 100;
    /* Starting from a positive offset pulls the line from the left */
    stroke-dashoffset: 100;
    animation: runningECG 2s ease-in-out infinite;

}
.splash-content h1 { color: #fff; font-size: 1.5rem; letter-spacing: 2px; }
.splash-content span { color: #6c5ce7; }
.splash-content p { color: #94a3b8; font-size: 0.8rem; margin-top: 10px; text-transform: uppercase; letter-spacing: 1px; }

@keyframes runningECG {
    0% {
        /* Line starts hidden on the left */
        stroke-dashoffset: -100;
    }
    50% {
        /* Line is fully drawn across the SVG */
        stroke-dashoffset: 0;
    }
    100% {
        /* Line exits to the right */
        stroke-dashoffset: 100;
    }
}
.pulse-logo svg {
    filter: drop-shadow(0 0 5px rgba(108, 92, 231, 0.5));
}
#splash-screen.fade-out { opacity: 0; visibility: hidden; pointer-events: none;}
    .nav-search-btn {
    background: none;
    border: none; /* Removes the white box/border */
    color: var(--text-main);
    cursor: pointer;
    padding: 8px;
    display: flex;
    align-items: center;
    outline: none; /* Removes the blue/white focus ring */
    box-shadow: none; /* Ensures no shadow is creating a box effect */
}

.header-right-controls { display: flex; align-items: center; gap: 8px; }

.nav-search-wrapper { position: relative; display: flex; align-items: center; }

.nav-search-expandable {
    position: absolute;
    right: 45px;
    top: 50%;
    transform: translateY(-50%);
    width: 0;
    /* CHANGE: Removed overflow: hidden from here so suggestions can show */
    transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    background: var(--card-bg);
    border-radius: 10px;
    z-index: 2001; /* Ensure it stays above everything */
}

.nav-search-expandable.active {
    width: 220px;
    border: 1px solid var(--primary);
    overflow: visible; /* CRITICAL: Allows suggestions to drop down */
}

/* Ensure the suggestions box sits clearly below the header */

.nav-search-input {
    width: 100%;
    padding: 10px 14px;
    border: none;
    background: transparent;
    color: var(--text-main);
    font-family: inherit;
    font-size: 0.9rem;
    outline: none;
}

/* Position suggestions correctly below the new top bar */
#navSug {
    position: absolute;
    top: 45px; /* Adjust based on header height */
    left: 0;
    width: 100%; /* Matches search bar width */
    background: var(--card-bg);
    border: 1px solid var(--nav-border);
    border-radius: 10px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    z-index: 3000;
    display: none; /* Controlled by JS */
}
/* --- Base Style for all tags --- */
.platform-tag {
    padding: 3px 8px;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: 8px;
    text-transform: uppercase;
}

/* --- Platform Specific Colors --- */
.platform-tag[data-p="PrepLadder"] { background: #ff7675; color: white; }
.platform-tag[data-p="Marrow"] { background: #5758bb; color: white; }
.platform-tag[data-p="Cerebellum"] { background: #2ecc71; color: white; }
.platform-tag[data-p="Doc Tutorial"] { background: #f39c12; color: white; }
.platform-tag[data-p="DAMS"] { background: #e74c3c; color: white; }
.platform-tag[data-p="eGurukul"] { background: #2c3e50; color: white; }
.platform-tag[data-p="Surgery Dada"] { background: #16a085; color: white; }

/* --- RR Override --- */
/* This ensures PrepLadder RR stays Cyan regardless of the base color */
.rr-tag { 
    background: #00cec9 !important; 
    color: white !important; 
    box-shadow: 0 0 10px rgba(0, 206, 201, 0.3);
}


    </style>
</head>
<body class="dark-mode">
    <div id="splash-screen">
    <div class="splash-content">
        <div class="pulse-logo">
    <svg width="100" height="80" viewBox="0 0 24 24" fill="none" stroke="#6c5ce7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path class="ecg-line" d="M22 12h-4l-3 9L9 3l-3 9H2"/>
    </svg>
</div>

        <h1>AJ MBBS <span>ARCHIVE</span></h1>
        <p>Initializing Clinical Modules...</p>
    </div>
</div>


   <header>
    <div class="header-left">
        <div class="menu-toggle" id="menuBtn">
            <div class="bar"></div><div class="bar"></div><div class="bar"></div>
        </div>
        <div class="header-title">AJ MBBS <span>ARCHIVE</span></div>
    </div>

    <div class="header-right-controls">
        <div class="nav-search-wrapper">
            <button class="nav-search-btn" id="navSearchTrigger" aria-label="Open Search">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
            </button>
            <div class="nav-search-expandable" id="navSearchExpandable">
                <input type="text" class="nav-search-input" placeholder="search subject..." oninput="liveSubjectSearch(this.value, 'navSug')">
                <div class="suggestions-box" id="navSug"></div>
            </div>
        </div>

        <button id="themeToggle">
            <svg id="moonIcon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
        </button>
    </div>
</header>


    <nav class="side-menu" id="sideMenu">
        <div class="side-menu-header">
            <div class="search-container" style="display: block; margin: 0; max-width: 100%;">
                <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                <input type="text" class="search-bar" id="menuSearch" placeholder="Search Subject..." oninput="liveSubjectSearch(this.value, 'menuSug')">
                <div class="suggestions-box" id="menuSug"></div>
            </div>
        </div>
        <ul class="menu-links">
            <li><a href="index.html">Dashboard</a></li>
            <li><a href="marrow.html">Marrow Ed8</a></li>
            <li><a href="prep.html">PrepLadder</a></li>
            <li><a href="cerebellum.html">Cerebellum</a></li>
            <li><a href="dams.html">DAMS / DVT</a></li>
            <li><a href="egurukul.html">eGurukul</a></li>
            <li><a href="doc.html">Doc Tutorial</a></li>
            <li><a href="surgery_dada.html">Surgery Dada</a></li>
            <li id="install-item" style="display:none;">
    <a href="#" onclick="directInstall()" style="background: rgba(108, 92, 231, 0.1); color: var(--primary); font-weight: 800; border: 1px dashed var(--primary);">
        ðŸ“¥ Install Archive App
    </a>
</li>

        </ul>
    </nav>
    <div class="overlay" id="overlay"></div>

    <div class="countdown-wrap" data-aos="zoom-in">
        <span style="font-weight: 800; text-transform: uppercase; letter-spacing: 2px; font-size: 0.75rem; color: #ef4444;">Milestone Countdown â€¢ NEET-PG 2026</span>
        <div class="timer-grid" id="timer">
            <div class="t-unit"><span class="t-num" id="days">00</span><span class="t-lab">Days</span></div>
            <div class="t-unit"><span class="t-num" id="hours">00</span><span class="t-lab">Hours</span></div>
            <div class="t-unit"><span class="t-num" id="mins">00</span><span class="t-lab">Mins</span></div>
            <div class="t-unit"><span class="t-num" id="secs">00</span><span class="t-lab">Secs</span></div>
        </div>
    </div>

    <section class="hero-section">
        <div class="hero-branding" data-aos="fade-up">
            <h1>AJ MEDICAL <span>ARCHIVE</span></h1>
            <div class="hero-divider"></div>
        </div> 
        <br><br>        
        <p class="hero-description" data-aos="fade-up" data-aos-delay="100">
            In the final stretch of the MBBS journey, efficiency is as critical as clinical acumen. 
            This portal serves as a centralized high-speed gateway to high-yield Q-Banks and interactive modules.
        </p>

        <div class="carousel-wrapper" data-aos="zoom-in">
            <div class="carousel-track">
                <a href="marrow.html" class="slide slide1"><div class="glass"><h2>MARROW</h2><p>Interactive Clinical Q-Banks</p></div></a>
                <a href="dams.html" class="slide slide2"><div class="glass"><h2>DAMS / DVT</h2><p>Recall Test Series</p></div></a>
                <a href="cerebellum.html" class="slide slide3"><div class="glass"><h2>CEREBELLUM</h2><p>Elite Subject Tests</p></div></a>
            </div>
        </div>
    </section>

    <div class="platform-grid" id="platformGrid">
        <a href="marrow.html" class="platform-card" data-aos="fade-up">
            <div class="icon-box"><img src="https://cdn-icons-png.flaticon.com/512/3063/3063171.png"></div>
            <div class="name">MARROW</div><div class="desc">Mock Series</div>
        </a>
        <a href="prep.html" class="platform-card" data-aos="fade-up" data-aos-delay="50">
            <div class="icon-box"><img src="https://cdn-icons-png.flaticon.com/512/3772/3772336.png"></div>
            <div class="name">PREPLADDER</div><div class="desc">Revision Hub</div>
        </a>
        <a href="cerebellum.html" class="platform-card" data-aos="fade-up" data-aos-delay="100">
            <div class="icon-box"><img src="https://cdn-icons-png.flaticon.com/512/10433/10433054.png"></div>
            <div class="name">CEREBELLUM</div><div class="desc">Recall Series</div>
        </a>
        <a href="doc.html" class="platform-card" data-aos="fade-up">
            <div class="icon-box"><img src="https://cdn-icons-png.flaticon.com/512/883/883356.png"></div>
            <div class="name">DOC TUTORIAL</div><div class="desc">Combined Tests</div>
        </a>
        <a href="dams.html" class="platform-card" data-aos="fade-up" data-aos-delay="50">
            <div class="icon-box"><img src="https://cdn-icons-png.flaticon.com/512/2785/2785482.png"></div>
            <div class="name">DAMS / DVT</div><div class="desc">Elite DQB</div>
        </a>
        <a href="egurukul.html" class="platform-card" data-aos="fade-up" data-aos-delay="100">
            <div class="icon-box"><img src="https://cdn-icons-png.flaticon.com/512/10044/10044877.png"></div>
            <div class="name">EGURUKUL</div><div class="desc">DBMCI Series</div>
        </a>
        <a href="surgery_dada.html" class="platform-card" data-aos="fade-up" data-aos-delay="150">
    <div class="icon-box"><img src="https://cdn-icons-png.flaticon.com/512/387/387561.png" alt="S"></div>
    <div class="name">SURGERY DADA</div><div class="desc">Clinical Surgery</div>
</a>
    </div>

    <div class="disclaimer" data-aos="fade-up">
        <h4 style="color:#ef4444; font-size:0.85rem; text-transform:uppercase; margin-bottom:8px;">DISCLAIMER</h4>
        <p style="font-size:0.9rem; color:var(--text-sub);">We are not the owner,seller or leaker.This platform acts as a directory for academic content found on public domains. We do not host proprietary data. For educational purposes only.</p>
    </div>

    <footer>
        &copy; 2026 AJ MBBS ARCHIVE | Elite edition
    </footer>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    // --- 1. INITIALIZATION & SPLASH ---
    window.addEventListener('load', () => {
        const splash = document.getElementById('splash-screen');
        setTimeout(() => {
            if(splash) splash.classList.add('fade-out');
        }, 1500);
    });

    AOS.init({ duration: 800, once: true });

   // --- 2. GLOBAL DATA ---
const subjects = [
    // --- Concept Series ---
    "Anatomy", "Physiology", "Biochemistry", "Pathology", "Microbiology", 
    "Pharmacology", "ENT", "Ophthalmology", "PSM", "FMT", "Medicine", 
    "Surgery", "OBGYN", "Pediatrics", "Orthopedics", "Dermatology", 
    "Psychiatry", "Radiology", "Anaesthesia",

    // --- Rapid Revision Series ---
    "Anatomy RR", "Physiology RR", "Biochemistry RR", "Pathology RR", 
    "Microbiology RR", "Pharmacology RR", "ENT RR", "Ophthalmology RR", 
    "PSM RR", "FMT RR", "Medicine RR", "Surgery RR", "OBGYN RR", 
    "Pediatrics RR", "Orthopedics RR", "Dermatology RR", "Psychiatry RR", 
    "Radiology RR", "Anaesthesia RR",

    // --- Exams & Tests ---
    "Surgery SS Exam Practice Test 1", "Surgery SS Exam Practice Test 2",
    "NEET SS Mega Exam Challenge 2025", "TD 1", "TD 2", "TD 3", "TD 4", "TD 5"
];

    const platforms = [
        {name: "Marrow", file: "marrow.html"},
        {name: "PrepLadder", file: "prep.html"},
        {name: "Cerebellum", file: "cerebellum.html"},
        {name: "Doc Tutorial", file: "doc.html"},
        {name: "DAMS", file: "dams.html"},
        {name: "eGurukul", file: "egurukul.html"},
        {name: "Surgery Dada", file: "surgery_dada.html"}
    ];

    // --- 3. SEARCH LOGIC (Corrected for RR exclusivity) ---
    function liveSubjectSearch(val, boxId) {
        const query = val.toLowerCase().trim();
        const box = document.getElementById(boxId);
        if (!box) return;
        
        box.innerHTML = '';
        if (query.length < 1) { 
            box.style.display = 'none'; 
            return; 
        }

        const filteredSubjects = subjects.filter(s => s.toLowerCase().includes(query));
        
        if (filteredSubjects.length > 0) {
            box.style.display = 'block';
            filteredSubjects.forEach(s => {
                // LOGIC: If subject contains "RR", show ONLY PrepLadder. 
                // Otherwise, show all platforms.
                const isRR = s.toUpperCase().includes("RR");
                const targetPlatforms = isRR 
                    ? platforms.filter(p => p.name === "PrepLadder") 
                    : platforms;

                targetPlatforms.forEach(p => {
                    const div = document.createElement('div');
                    div.className = 'suggestion-item';
                    
                    // Add a specific class for RR tags if you want to style them cyan
                    const tagClass = isRR ? 'platform-tag rr-tag' : 'platform-tag';
                    
                    // Adding data-p attribute allows CSS to target specific platform names
div.innerHTML = `<span>${s}</span><span class="${tagClass}" data-p="${p.name}">${p.name}</span>`;

                    div.onclick = (e) => {
                        e.stopPropagation();
                        window.location.href = `${p.file}?subject=${encodeURIComponent(s)}`;
                    };
                    box.appendChild(div);
                });
            });
        } else { 
            box.style.display = 'none'; 
        }
    }

    // --- 4. TOP NAV SEARCH CONTROLS ---
    const navSearchTrigger = document.getElementById('navSearchTrigger');
    const navSearchExpandable = document.getElementById('navSearchExpandable');

    if (navSearchTrigger && navSearchExpandable) {
        const input = navSearchExpandable.querySelector('input');
        
        navSearchTrigger.onclick = (e) => {
            e.stopPropagation();
            const isActive = navSearchExpandable.classList.toggle('active');
            if (isActive) {
                setTimeout(() => { input.focus(); }, 50);
            } else {
                input.value = '';
                const navSug = document.getElementById('navSug');
                if(navSug) navSug.style.display = 'none';
            }
        };
    }

    document.addEventListener('click', (e) => {
        if (navSearchExpandable && !e.target.closest('.nav-search-wrapper')) {
            navSearchExpandable.classList.remove('active');
            const navSug = document.getElementById('navSug');
            if(navSug) navSug.style.display = 'none';
            const input = navSearchExpandable.querySelector('input');
            if(input) input.value = '';
        }
        if (!e.target.closest('.side-menu')) {
            const menuSug = document.getElementById('menuSug');
            if(menuSug) menuSug.style.display = 'none';
        }
    });

    // --- 5. PWA & INSTALL LOGIC ---
    let deferredPrompt;
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('./sw.js')
                .then(reg => console.log('Archive SW Registered'))
                .catch(err => console.error('SW Failed', err));
        });
    }

    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        const installItem = document.getElementById('install-item');
        if(installItem) installItem.style.display = 'block';
    });

    async function directInstall() {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            if (outcome === 'accepted') {
                const item = document.getElementById('install-item');
                if(item) item.style.display = 'none';
            }
            deferredPrompt = null;
        } else {
            alert("Open browser menu and select 'Add to Home Screen' to install.");
        }
    }

    // --- 6. UI UTILITIES (Timer, Theme) ---
    function updateTimer() {
        const examDate = new Date("March 5, 2026 09:00:00").getTime();
        const now = new Date().getTime();
        const diff = examDate - now;
        
        if (diff <= 0) {
            const timerEl = document.getElementById("timer");
            if(timerEl) timerEl.innerHTML = "EXAM DAY";
            return;
        }

        const d = Math.floor(diff / (1000 * 60 * 60 * 24));
        const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const s = Math.floor((diff % (1000 * 60)) / 1000);

        if(document.getElementById("days")) document.getElementById("days").innerText = d.toString().padStart(2, '0');
        if(document.getElementById("hours")) document.getElementById("hours").innerText = h.toString().padStart(2, '0');
        if(document.getElementById("mins")) document.getElementById("mins").innerText = m.toString().padStart(2, '0');
        if(document.getElementById("secs")) document.getElementById("secs").innerText = s.toString().padStart(2, '0');
    }
    setInterval(updateTimer, 1000); 
    updateTimer();

    const menuBtn = document.getElementById('menuBtn');
    const sideMenu = document.getElementById('sideMenu');
    const overlay = document.getElementById('overlay');
    
    if(menuBtn && sideMenu && overlay) {
        menuBtn.onclick = () => { sideMenu.classList.add('active'); overlay.classList.add('active'); };
        overlay.onclick = () => { sideMenu.classList.remove('active'); overlay.classList.remove('active'); };
    }

    const themeToggle = document.getElementById('themeToggle');
    if(themeToggle) {
        themeToggle.onclick = () => {
            document.body.classList.toggle('light-mode');
            localStorage.setItem('theme', document.body.classList.contains('light-mode') ? 'light' : 'dark');
        };
    }
    if(localStorage.getItem('theme') === 'light') document.body.classList.add('light-mode');
</script>



</body>
</html>
